# -*- coding: utf-8 -*-
# ------------------------------------------------------------------------------
#
#   Copyright 2024 Valory AG
#
#   Licensed under the Apache License, Version 2.0 (the "License");
#   you may not use this file except in compliance with the License.
#   You may obtain a copy of the License at
#
#       http://www.apache.org/licenses/LICENSE-2.0
#
#   Unless required by applicable law or agreed to in writing, software
#   distributed under the License is distributed on an "AS IS" BASIS,
#   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
#   See the License for the specific language governing permissions and
#   limitations under the License.
#
# ------------------------------------------------------------------------------

"""
Tests for the strategy module
"""

import json
import pytest

import random
import pandas as pd


from strategies.sma_strategy import sma_strategy as sma_strategy
from strategies.rsi_strategy import rsi_strategy
from strategies.trend_following_strategy import trend_following_strategy
from unittest import TestCase

import json

import pandas as pd


DEFAULT_OHLCV_PERIOD = "5Min"
DEFAULT_ENCODING = "utf-8"


strategies = [sma_strategy, rsi_strategy, trend_following_strategy]

OHLCV_DATA = "strategies/data/olas_5m.csv"


SAMPLE_RUN_DATA = {
    "ma_period": 35,
    "transformed_data": '{"Date Time":{"0":"2024-03-07 10:40:00","1":"2024-03-07 10:45:00","2":"2024-03-07 10:50:00","3":"2024-03-07 10:55:00","4":"2024-03-07 11:00:00","5":"2024-03-07 11:05:00","6":"2024-03-07 11:10:00","7":"2024-03-07 11:15:00","8":"2024-03-07 11:20:00","9":"2024-03-07 11:25:00","10":"2024-03-07 11:30:00","11":"2024-03-07 11:35:00","12":"2024-03-07 11:40:00","13":"2024-03-07 11:45:00","14":"2024-03-07 11:50:00","15":"2024-03-07 11:55:00","16":"2024-03-07 12:00:00","17":"2024-03-07 12:05:00","18":"2024-03-07 12:10:00","19":"2024-03-07 12:15:00","20":"2024-03-07 12:20:00","21":"2024-03-07 12:25:00","22":"2024-03-07 12:30:00","23":"2024-03-07 12:35:00","24":"2024-03-07 12:40:00","25":"2024-03-07 12:45:00","26":"2024-03-07 12:50:00","27":"2024-03-07 12:55:00","28":"2024-03-07 13:00:00","29":"2024-03-07 13:05:00","30":"2024-03-07 13:10:00","31":"2024-03-07 13:15:00","32":"2024-03-07 13:20:00","33":"2024-03-07 13:25:00","34":"2024-03-07 13:30:00","35":"2024-03-07 13:35:00","36":"2024-03-07 13:40:00","37":"2024-03-07 13:45:00","38":"2024-03-07 13:50:00","39":"2024-03-07 13:55:00","40":"2024-03-07 14:00:00","41":"2024-03-07 14:05:00","42":"2024-03-07 14:10:00","43":"2024-03-07 14:15:00","44":"2024-03-07 14:20:00","45":"2024-03-07 14:25:00","46":"2024-03-07 14:30:00","47":"2024-03-07 14:35:00","48":"2024-03-07 14:40:00","49":"2024-03-07 14:45:00","50":"2024-03-07 14:50:00","51":"2024-03-07 14:55:00","52":"2024-03-07 15:00:00","53":"2024-03-07 15:05:00","54":"2024-03-07 15:10:00","55":"2024-03-07 15:15:00","56":"2024-03-07 15:20:00","57":"2024-03-07 15:25:00","58":"2024-03-07 15:30:00","59":"2024-03-07 15:35:00","60":"2024-03-07 15:40:00","61":"2024-03-07 15:45:00","62":"2024-03-07 15:50:00","63":"2024-03-07 15:55:00","64":"2024-03-07 16:00:00","65":"2024-03-07 16:05:00","66":"2024-03-07 16:10:00","67":"2024-03-07 16:15:00","68":"2024-03-07 16:20:00","69":"2024-03-07 16:25:00","70":"2024-03-07 16:30:00","71":"2024-03-07 16:35:00","72":"2024-03-07 16:40:00","73":"2024-03-07 16:45:00","74":"2024-03-07 16:50:00","75":"2024-03-07 16:55:00","76":"2024-03-07 17:00:00","77":"2024-03-07 17:05:00","78":"2024-03-07 17:10:00","79":"2024-03-07 17:15:00","80":"2024-03-07 17:20:00","81":"2024-03-07 17:25:00","82":"2024-03-07 17:30:00","83":"2024-03-07 17:35:00","84":"2024-03-07 17:40:00","85":"2024-03-07 17:45:00","86":"2024-03-07 17:50:00","87":"2024-03-07 17:55:00","88":"2024-03-07 18:00:00","89":"2024-03-07 18:05:00","90":"2024-03-07 18:10:00","91":"2024-03-07 18:15:00","92":"2024-03-07 18:20:00","93":"2024-03-07 18:25:00","94":"2024-03-07 18:30:00","95":"2024-03-07 18:35:00","96":"2024-03-07 18:40:00","97":"2024-03-07 18:45:00","98":"2024-03-07 18:50:00","99":"2024-03-07 18:55:00","100":"2024-03-07 19:00:00","101":"2024-03-07 19:05:00","102":"2024-03-07 19:10:00","103":"2024-03-07 19:15:00","104":"2024-03-07 19:20:00","105":"2024-03-07 19:25:00","106":"2024-03-07 19:30:00","107":"2024-03-07 19:35:00","108":"2024-03-07 19:40:00","109":"2024-03-07 19:45:00","110":"2024-03-07 19:50:00","111":"2024-03-07 19:55:00","112":"2024-03-07 20:00:00","113":"2024-03-07 20:05:00","114":"2024-03-07 20:10:00","115":"2024-03-07 20:15:00","116":"2024-03-07 20:20:00","117":"2024-03-07 20:25:00","118":"2024-03-07 20:30:00","119":"2024-03-07 20:35:00","120":"2024-03-07 20:40:00","121":"2024-03-07 20:45:00","122":"2024-03-07 20:50:00","123":"2024-03-07 20:55:00","124":"2024-03-07 21:00:00","125":"2024-03-07 21:05:00","126":"2024-03-07 21:10:00","127":"2024-03-07 21:15:00","128":"2024-03-07 21:20:00","129":"2024-03-07 21:25:00","130":"2024-03-07 21:30:00","131":"2024-03-07 21:35:00","132":"2024-03-07 21:40:00","133":"2024-03-07 21:45:00","134":"2024-03-07 21:50:00","135":"2024-03-07 21:55:00","136":"2024-03-07 22:00:00","137":"2024-03-07 22:05:00","138":"2024-03-07 22:10:00","139":"2024-03-07 22:15:00","140":"2024-03-07 22:20:00","141":"2024-03-07 22:25:00","142":"2024-03-07 22:30:00","143":"2024-03-07 22:35:00","144":"2024-03-07 22:40:00","145":"2024-03-07 22:45:00","146":"2024-03-07 22:50:00","147":"2024-03-07 22:55:00","148":"2024-03-07 23:00:00","149":"2024-03-07 23:05:00","150":"2024-03-07 23:10:00","151":"2024-03-07 23:15:00","152":"2024-03-07 23:20:00","153":"2024-03-07 23:25:00","154":"2024-03-07 23:30:00","155":"2024-03-07 23:35:00","156":"2024-03-07 23:40:00","157":"2024-03-07 23:45:00","158":"2024-03-07 23:50:00","159":"2024-03-07 23:55:00","160":"2024-03-08 00:00:00","161":"2024-03-08 00:05:00","162":"2024-03-08 00:10:00","163":"2024-03-08 00:15:00","164":"2024-03-08 00:20:00","165":"2024-03-08 00:25:00","166":"2024-03-08 00:30:00","167":"2024-03-08 00:35:00","168":"2024-03-08 00:40:00","169":"2024-03-08 00:45:00","170":"2024-03-08 00:50:00","171":"2024-03-08 00:55:00","172":"2024-03-08 01:00:00","173":"2024-03-08 01:05:00","174":"2024-03-08 01:10:00","175":"2024-03-08 01:15:00","176":"2024-03-08 01:20:00","177":"2024-03-08 01:25:00","178":"2024-03-08 01:30:00","179":"2024-03-08 01:35:00","180":"2024-03-08 01:40:00","181":"2024-03-08 01:45:00","182":"2024-03-08 01:50:00","183":"2024-03-08 01:55:00","184":"2024-03-08 02:00:00","185":"2024-03-08 02:05:00","186":"2024-03-08 02:10:00","187":"2024-03-08 02:15:00","188":"2024-03-08 02:20:00","189":"2024-03-08 02:25:00","190":"2024-03-08 02:30:00","191":"2024-03-08 02:35:00","192":"2024-03-08 02:40:00","193":"2024-03-08 02:45:00","194":"2024-03-08 02:50:00","195":"2024-03-08 02:55:00","196":"2024-03-08 03:00:00","197":"2024-03-08 03:05:00","198":"2024-03-08 03:10:00","199":"2024-03-08 03:15:00","200":"2024-03-08 03:20:00","201":"2024-03-08 03:25:00","202":"2024-03-08 03:30:00","203":"2024-03-08 03:35:00","204":"2024-03-08 03:40:00","205":"2024-03-08 03:45:00","206":"2024-03-08 03:50:00","207":"2024-03-08 03:55:00","208":"2024-03-08 04:00:00","209":"2024-03-08 04:05:00","210":"2024-03-08 04:10:00","211":"2024-03-08 04:15:00","212":"2024-03-08 04:20:00","213":"2024-03-08 04:25:00","214":"2024-03-08 04:30:00","215":"2024-03-08 04:35:00","216":"2024-03-08 04:40:00","217":"2024-03-08 04:45:00","218":"2024-03-08 04:50:00","219":"2024-03-08 04:55:00","220":"2024-03-08 05:00:00","221":"2024-03-08 05:05:00","222":"2024-03-08 05:10:00","223":"2024-03-08 05:15:00","224":"2024-03-08 05:20:00","225":"2024-03-08 05:25:00","226":"2024-03-08 05:30:00","227":"2024-03-08 05:35:00","228":"2024-03-08 05:40:00","229":"2024-03-08 05:45:00","230":"2024-03-08 05:50:00","231":"2024-03-08 05:55:00","232":"2024-03-08 06:00:00","233":"2024-03-08 06:05:00","234":"2024-03-08 06:10:00","235":"2024-03-08 06:15:00","236":"2024-03-08 06:20:00","237":"2024-03-08 06:25:00","238":"2024-03-08 06:30:00","239":"2024-03-08 06:35:00","240":"2024-03-08 06:40:00","241":"2024-03-08 06:45:00","242":"2024-03-08 06:50:00","243":"2024-03-08 06:55:00","244":"2024-03-08 07:00:00","245":"2024-03-08 07:05:00","246":"2024-03-08 07:10:00","247":"2024-03-08 07:15:00","248":"2024-03-08 07:20:00","249":"2024-03-08 07:25:00","250":"2024-03-08 07:30:00","251":"2024-03-08 07:35:00","252":"2024-03-08 07:40:00","253":"2024-03-08 07:45:00","254":"2024-03-08 07:50:00","255":"2024-03-08 07:55:00","256":"2024-03-08 08:00:00","257":"2024-03-08 08:05:00","258":"2024-03-08 08:10:00","259":"2024-03-08 08:15:00","260":"2024-03-08 08:20:00","261":"2024-03-08 08:25:00","262":"2024-03-08 08:30:00","263":"2024-03-08 08:35:00","264":"2024-03-08 08:40:00","265":"2024-03-08 08:45:00","266":"2024-03-08 08:50:00","267":"2024-03-08 08:55:00","268":"2024-03-08 09:00:00","269":"2024-03-08 09:05:00","270":"2024-03-08 09:10:00","271":"2024-03-08 09:15:00","272":"2024-03-08 09:20:00","273":"2024-03-08 09:25:00","274":"2024-03-08 09:30:00","275":"2024-03-08 09:35:00","276":"2024-03-08 09:40:00","277":"2024-03-08 09:45:00","278":"2024-03-08 09:50:00","279":"2024-03-08 09:55:00","280":"2024-03-08 10:00:00","281":"2024-03-08 10:05:00","282":"2024-03-08 10:10:00","283":"2024-03-08 10:15:00","284":"2024-03-08 10:20:00","285":"2024-03-08 10:25:00","286":"2024-03-08 10:30:00","287":"2024-03-08 10:35:00"},"Open":{"0":3770.1906944402,"1":3769.8483295945,"2":3769.867140573,"3":3772.6717685996,"4":3776.4668124829,"5":3786.9402344311,"6":3799.7914382712,"7":3788.8328228523,"8":3771.6240759019,"9":3771.6615246171,"10":3772.3512758386,"11":3775.0813728046,"12":3771.3242780793,"13":3775.1754460862,"14":3771.0130442093,"15":3771.0130442093,"16":3773.9514721932,"17":3781.9230996675,"18":3787.0644746868,"19":3792.5813075788,"20":3793.4897125126,"21":3783.2387417512,"22":3783.2387417512,"23":3784.1610704482,"24":3787.4273230456,"25":3785.1497953997,"26":3780.8773260457,"27":3780.7974364833,"28":3779.1721854747,"29":3785.9197886135,"30":3787.0123587782,"31":3780.2333444785,"32":3782.2778421984,"33":3784.315032511,"34":3784.3832620036,"35":3785.9262430797,"36":3788.2320598506,"37":3786.5662173888,"38":3790.9862316209,"39":3788.7874049355,"40":3789.0238085397,"41":3793.1999180463,"42":3815.800161471,"43":3811.7616463359,"44":3808.8267471438,"45":3810.0618292369,"46":3796.1465000206,"47":3794.8316849747,"48":3799.6335622351,"49":3833.1342920881,"50":3817.0566333042,"51":3819.5763193748,"52":3823.7886162309,"53":3821.8956952819,"54":3822.4644232435,"55":3824.5805187074,"56":3825.3564808172,"57":3825.2002192883,"58":3824.6164913703,"59":3825.3232357202,"60":3824.8770454197,"61":3823.8954513506,"62":3824.2437917452,"63":3828.9638544406,"64":3822.5164124001,"65":3823.0388229082,"66":3822.7887303638,"67":3821.303510654,"68":3822.5856032616,"69":3822.1030535488,"70":3817.7834551938,"71":3817.3362645446,"72":3811.9320615685,"73":3817.702184965,"74":3817.6247403668,"75":3817.8712763696,"76":3817.6087327237,"77":3816.4620688419,"78":3817.1565827852,"79":3816.6602169842,"80":3816.1996749032,"81":3816.6515705732,"82":3816.406007046,"83":3816.3442445253,"84":3815.8260859651,"85":3816.847291646,"86":3816.3776055351,"87":3816.4556305309,"88":3817.7525596432,"89":3817.7636537081,"90":3818.8764613043,"91":3817.3653751593,"92":3817.9290763098,"93":3814.7422840426,"94":3817.832541133,"95":3813.8377976617,"96":3814.3527932988,"97":3814.2799916084,"98":3818.2732700501,"99":3814.0688792611,"100":3814.1555101343,"101":3814.5872951325,"102":3811.7284680451,"103":3813.4219294509,"104":3810.717617246,"105":3813.7341943528,"106":3815.0260961777,"107":3817.693976123,"108":3818.1323199797,"109":3818.4545637389,"110":3817.7259950528,"111":3818.2123968287,"112":3817.5090857173,"113":3818.2651422064,"114":3817.5385194413,"115":3814.3624427859,"116":3871.0100886869,"117":3856.1831838829,"118":3856.7392000211,"119":3892.2080958907,"120":3882.9925825804,"121":3878.9745445455,"122":3923.1045267681,"123":3911.8811828702,"124":3900.0366527431,"125":3900.7063731795,"126":3900.4699801422,"127":3896.9304053207,"128":3898.5454465514,"129":3898.5027092012,"130":3898.2245062292,"131":3897.6573309219,"132":3901.2469340733,"133":3899.5094893385,"134":3898.7778307428,"135":3897.8079732801,"136":3899.5398363774,"137":3902.4640247537,"138":3902.4640247537,"139":3897.8214418092,"140":3897.8214418092,"141":3897.3252693733,"142":3899.92548485,"143":3897.7760786952,"144":3890.7158529137,"145":3885.9365836417,"146":3887.3047826554,"147":3890.5314993053,"148":3875.418935081,"149":3849.0099459593,"150":3839.9425907106,"151":3838.0774450763,"152":3837.5817459317,"153":3835.7055833447,"154":3847.9894575663,"155":3840.2370819057,"156":3840.2370819057,"157":3840.2370819057,"158":3839.6455831804,"159":3840.2993000438,"160":3838.876463346,"161":3840.0534255094,"162":3840.4051751439,"163":3840.4051751439,"164":3838.0762826072,"165":3839.8067458585,"166":3867.0197640658,"167":3859.1572742894,"168":3860.4510869931,"169":3860.4777118958,"170":3861.5865677121,"171":3861.5120649628,"172":3861.8352774692,"173":3886.6138227867,"174":3882.3515370949,"175":3911.1675771676,"176":3913.7342750094,"177":3913.3418656536,"178":3922.9483620118,"179":3915.8871334133,"180":3914.6532410641,"181":3913.0622242549,"182":3913.534763944,"183":3913.8122478062,"184":3903.2417146172,"185":3905.2447617515,"186":3903.6130229859,"187":3903.6130229859,"188":3903.649177645,"189":3912.6638379112,"190":3910.8496029287,"191":3911.288685872,"192":3911.0468378574,"193":3911.2128609714,"194":3912.8404648319,"195":3913.3224173375,"196":3904.7147532633,"197":3904.1634634886,"198":3907.8722617981,"199":3906.2828706471,"200":3903.9030118149,"201":3905.3242981929,"202":3904.7974107902,"203":3903.5699626898,"204":3904.7694319346,"205":3910.8930373837,"206":3911.4476629107,"207":3911.42747673,"208":3912.286844006,"209":3912.3886369926,"210":3912.3420943513,"211":3913.0523389591,"212":3909.917938433,"213":3912.1447395762,"214":3911.9165549874,"215":3908.4309402705,"216":3908.4309402705,"217":3911.6453370209,"218":3911.9757363863,"219":3911.8231701897,"220":3924.3005838724,"221":3924.1597058313,"222":3918.3072522829,"223":3923.0025383978,"224":3922.648989012,"225":3876.1939152347,"226":3876.0255633,"227":3875.8271669081,"228":3875.2230341387,"229":3871.874721896,"230":3871.7848296923,"231":3862.8122323289,"232":3862.4880688772,"233":3870.2037044385,"234":3870.2037044385,"235":3855.1385513579,"236":3854.6861117949,"237":3855.0939644451,"238":3856.732266005,"239":3856.732266005,"240":3856.917529958,"241":3854.5651585737,"242":3856.9659431882,"243":3855.5956556052,"244":3855.6522889882,"245":3876.6917868225,"246":3878.0538287595,"247":3878.0538287595,"248":3879.2261389343,"249":3877.1654175113,"250":3910.5580459332,"251":3918.7005996188,"252":3928.9646515886,"253":3928.9646515886,"254":3932.8705945412,"255":3913.0941334778,"256":3915.0539849534,"257":3917.9885124913,"258":3918.540611968,"259":3919.4566266617,"260":3920.7884518657,"261":3926.243660916,"262":3932.1042672717,"263":3945.6819784352,"264":3958.6205253452,"265":3955.63112804,"266":3956.422217191,"267":3951.24502232,"268":3948.9923000879,"269":3945.1307017013,"270":3940.4164457103,"271":3947.4083365549,"272":3950.4778707164,"273":3941.8867198363,"274":3944.9956969236,"275":3953.812213552,"276":3953.812213552,"277":3950.4539779509,"278":3943.1556330362,"279":3945.9193397056,"280":3937.7418953311,"281":3933.4643258158,"282":3933.4643258158,"283":3925.8382965154,"284":3933.7434425774,"285":3927.8201419014,"286":3938.1269461241,"287":3945.3653905429},"High":{"0":3770.1906944402,"1":3769.8483295945,"2":3769.867140573,"3":3772.6717685996,"4":3776.4668124829,"5":3786.9402344311,"6":3799.7914382712,"7":3788.8328228523,"8":3771.6240759019,"9":3771.6615246171,"10":3772.3512758386,"11":3775.0813728046,"12":3771.3242780793,"13":3775.1754460862,"14":3771.0130442093,"15":3771.0130442093,"16":3773.9514721932,"17":3781.9230996675,"18":3787.0644746868,"19":3792.5813075788,"20":3793.4897125126,"21":3783.2387417512,"22":3783.2387417512,"23":3784.1610704482,"24":3787.4273230456,"25":3785.1497953997,"26":3780.8773260457,"27":3780.7974364833,"28":3779.1721854747,"29":3785.9197886135,"30":3787.0123587782,"31":3780.2333444785,"32":3782.2778421984,"33":3784.315032511,"34":3784.3832620036,"35":3785.9262430797,"36":3788.2320598506,"37":3786.5662173888,"38":3790.9862316209,"39":3788.7874049355,"40":3789.0238085397,"41":3793.1999180463,"42":3815.800161471,"43":3811.7616463359,"44":3808.8267471438,"45":3810.0618292369,"46":3796.1465000206,"47":3794.8316849747,"48":3799.6335622351,"49":3833.1342920881,"50":3817.0566333042,"51":3819.5763193748,"52":3823.7886162309,"53":3821.8956952819,"54":3822.4644232435,"55":3824.5805187074,"56":3825.3564808172,"57":3825.2002192883,"58":3824.6164913703,"59":3825.3232357202,"60":3824.8770454197,"61":3823.8954513506,"62":3824.2437917452,"63":3828.9638544406,"64":3822.5164124001,"65":3823.0388229082,"66":3822.7887303638,"67":3821.303510654,"68":3822.5856032616,"69":3822.1030535488,"70":3817.7834551938,"71":3817.3362645446,"72":3811.9320615685,"73":3817.702184965,"74":3817.6247403668,"75":3817.8712763696,"76":3817.6087327237,"77":3816.4620688419,"78":3817.1565827852,"79":3816.6602169842,"80":3816.1996749032,"81":3816.6515705732,"82":3816.406007046,"83":3816.3442445253,"84":3815.8260859651,"85":3816.847291646,"86":3816.3776055351,"87":3816.4556305309,"88":3817.7525596432,"89":3817.7636537081,"90":3818.8764613043,"91":3817.3653751593,"92":3817.9290763098,"93":3814.7422840426,"94":3817.832541133,"95":3813.8377976617,"96":3814.3527932988,"97":3814.2799916084,"98":3818.2732700501,"99":3814.0688792611,"100":3814.1555101343,"101":3814.5872951325,"102":3811.7284680451,"103":3813.4219294509,"104":3810.717617246,"105":3813.7341943528,"106":3815.0260961777,"107":3817.693976123,"108":3818.1323199797,"109":3818.4545637389,"110":3817.7259950528,"111":3818.2123968287,"112":3817.5090857173,"113":3818.2651422064,"114":3817.5385194413,"115":3814.3624427859,"116":3871.0100886869,"117":3856.1831838829,"118":3856.7392000211,"119":3892.2080958907,"120":3882.9925825804,"121":3878.9745445455,"122":3923.1045267681,"123":3911.8811828702,"124":3900.0366527431,"125":3900.7063731795,"126":3900.4699801422,"127":3896.9304053207,"128":3898.5454465514,"129":3898.5027092012,"130":3898.2245062292,"131":3897.6573309219,"132":3901.2469340733,"133":3899.5094893385,"134":3898.7778307428,"135":3901.2072078946,"136":3899.5398363774,"137":3902.4640247537,"138":3902.4640247537,"139":3897.8214418092,"140":3897.8214418092,"141":3897.3252693733,"142":3899.92548485,"143":3897.7760786952,"144":3890.7158529137,"145":3885.9365836417,"146":3887.3047826554,"147":3890.5314993053,"148":3875.418935081,"149":3849.0099459593,"150":3839.9425907106,"151":3838.0774450763,"152":3837.5817459317,"153":3835.7055833447,"154":3847.9894575663,"155":3840.2370819057,"156":3840.2370819057,"157":3840.2370819057,"158":3839.6455831804,"159":3840.2993000438,"160":3838.876463346,"161":3840.422611848,"162":3840.4051751439,"163":3840.4051751439,"164":3838.0762826072,"165":3839.8067458585,"166":3867.0197640658,"167":3859.1572742894,"168":3860.4510869931,"169":3860.4777118958,"170":3861.5865677121,"171":3861.5120649628,"172":3861.8352774692,"173":3886.6138227867,"174":3882.3515370949,"175":3911.1675771676,"176":3913.7342750094,"177":3913.3418656536,"178":3922.9483620118,"179":3915.8871334133,"180":3914.6532410641,"181":3913.0622242549,"182":3913.534763944,"183":3913.8122478062,"184":3903.2417146172,"185":3905.2447617515,"186":3903.6130229859,"187":3903.6130229859,"188":3903.649177645,"189":3912.6638379112,"190":3910.8496029287,"191":3911.288685872,"192":3911.0468378574,"193":3911.2128609714,"194":3912.8404648319,"195":3913.3224173375,"196":3904.7147532633,"197":3904.1634634886,"198":3907.8722617981,"199":3906.2828706471,"200":3903.9030118149,"201":3905.3242981929,"202":3904.7974107902,"203":3903.5699626898,"204":3904.7694319346,"205":3910.8930373837,"206":3911.4476629107,"207":3911.42747673,"208":3912.286844006,"209":3912.3886369926,"210":3912.3420943513,"211":3913.0523389591,"212":3909.917938433,"213":3912.1447395762,"214":3911.9165549874,"215":3908.4309402705,"216":3908.4309402705,"217":3911.6453370209,"218":3911.9757363863,"219":3911.8231701897,"220":3924.3005838724,"221":3924.1597058313,"222":3918.3072522829,"223":3923.0025383978,"224":3922.648989012,"225":3876.1939152347,"226":3876.0255633,"227":3875.8271669081,"228":3875.2230341387,"229":3871.874721896,"230":3871.9656184858,"231":3862.8122323289,"232":3862.4880688772,"233":3870.2037044385,"234":3870.2037044385,"235":3855.1385513579,"236":3854.6861117949,"237":3855.5660040051,"238":3856.732266005,"239":3856.732266005,"240":3856.917529958,"241":3854.5651585737,"242":3856.9659431882,"243":3855.5956556052,"244":3855.6522889882,"245":3876.6917868225,"246":3878.0538287595,"247":3878.0538287595,"248":3879.2261389343,"249":3877.1654175113,"250":3910.5580459332,"251":3918.7005996188,"252":3928.9646515886,"253":3928.9646515886,"254":3932.8705945412,"255":3913.0941334778,"256":3915.0539849534,"257":3917.9885124913,"258":3918.540611968,"259":3919.4566266617,"260":3920.7884518657,"261":3926.243660916,"262":3932.1042672717,"263":3945.6819784352,"264":3958.6205253452,"265":3955.63112804,"266":3956.422217191,"267":3951.24502232,"268":3948.9923000879,"269":3945.1307017013,"270":3940.4164457103,"271":3947.4083365549,"272":3950.4778707164,"273":3941.8867198363,"274":3947.2299749811,"275":3953.812213552,"276":3953.812213552,"277":3950.4539779509,"278":3943.1556330362,"279":3945.9193397056,"280":3937.7418953311,"281":3933.4643258158,"282":3933.4643258158,"283":3925.8382965154,"284":3933.7434425774,"285":3927.8201419014,"286":3938.1269461241,"287":3945.3653905429},"Low":{"0":3770.1906944402,"1":3769.8483295945,"2":3769.867140573,"3":3772.6717685996,"4":3776.4668124829,"5":3786.9402344311,"6":3799.7914382712,"7":3788.8328228523,"8":3771.6240759019,"9":3771.6615246171,"10":3772.3512758386,"11":3775.0813728046,"12":3771.3242780793,"13":3774.8282898239,"14":3771.0130442093,"15":3771.0130442093,"16":3773.9514721932,"17":3781.9230996675,"18":3787.0644746868,"19":3792.5813075788,"20":3793.4897125126,"21":3783.2387417512,"22":3783.2387417512,"23":3784.1610704482,"24":3787.4273230456,"25":3785.1497953997,"26":3780.8773260457,"27":3780.7974364833,"28":3779.1721854747,"29":3785.9197886135,"30":3787.0123587782,"31":3780.2333444785,"32":3782.2778421984,"33":3784.315032511,"34":3784.3832620036,"35":3785.9262430797,"36":3788.2320598506,"37":3786.5662173888,"38":3790.9862316209,"39":3788.7874049355,"40":3789.0238085397,"41":3793.1999180463,"42":3815.800161471,"43":3811.7616463359,"44":3808.8267471438,"45":3810.0618292369,"46":3796.1465000206,"47":3794.8316849747,"48":3799.6335622351,"49":3833.1342920881,"50":3817.0566333042,"51":3819.5763193748,"52":3823.7886162309,"53":3821.8956952819,"54":3822.4644232435,"55":3824.5805187074,"56":3825.3564808172,"57":3825.2002192883,"58":3824.6164913703,"59":3825.3232357202,"60":3824.8770454197,"61":3823.8954513506,"62":3824.2437917452,"63":3828.9638544406,"64":3822.5164124001,"65":3823.0388229082,"66":3822.7887303638,"67":3821.303510654,"68":3822.5856032616,"69":3822.1030535488,"70":3817.7834551938,"71":3817.3362645446,"72":3811.9320615685,"73":3817.702184965,"74":3817.6247403668,"75":3817.8712763696,"76":3817.6087327237,"77":3816.4620688419,"78":3817.1565827852,"79":3816.6602169842,"80":3816.1996749032,"81":3816.6515705732,"82":3816.406007046,"83":3816.3442445253,"84":3815.8260859651,"85":3816.847291646,"86":3816.3776055351,"87":3816.4556305309,"88":3817.7525596432,"89":3817.7636537081,"90":3818.8764613043,"91":3817.3653751593,"92":3817.9290763098,"93":3814.7422840426,"94":3817.832541133,"95":3813.8377976617,"96":3814.3527932988,"97":3814.2799916084,"98":3818.2732700501,"99":3814.0688792611,"100":3814.1555101343,"101":3814.5872951325,"102":3811.7284680451,"103":3813.4219294509,"104":3810.717617246,"105":3813.7341943528,"106":3815.0260961777,"107":3817.693976123,"108":3818.1323199797,"109":3818.4545637389,"110":3817.7259950528,"111":3818.2123968287,"112":3817.5090857173,"113":3818.2651422064,"114":3817.5385194413,"115":3814.3624427859,"116":3871.0100886869,"117":3856.1831838829,"118":3856.7392000211,"119":3892.2080958907,"120":3882.9925825804,"121":3878.9745445455,"122":3923.1045267681,"123":3911.8811828702,"124":3900.0366527431,"125":3900.7063731795,"126":3900.4699801422,"127":3896.9304053207,"128":3898.5454465514,"129":3898.5027092012,"130":3898.2245062292,"131":3897.6573309219,"132":3901.2469340733,"133":3899.5094893385,"134":3898.7778307428,"135":3897.8079732801,"136":3899.5398363774,"137":3897.943957195,"138":3897.943957195,"139":3897.8214418092,"140":3897.8214418092,"141":3897.3252693733,"142":3899.92548485,"143":3897.7760786952,"144":3890.7158529137,"145":3885.9365836417,"146":3887.3047826554,"147":3890.5314993053,"148":3875.418935081,"149":3849.0099459593,"150":3839.9425907106,"151":3838.0774450763,"152":3837.5817459317,"153":3835.7055833447,"154":3847.9894575663,"155":3840.2370819057,"156":3840.2370819057,"157":3840.2370819057,"158":3839.6455831804,"159":3840.2993000438,"160":3838.876463346,"161":3840.0534255094,"162":3840.4051751439,"163":3840.4051751439,"164":3838.0762826072,"165":3839.8067458585,"166":3867.0197640658,"167":3859.1572742894,"168":3860.4510869931,"169":3860.4777118958,"170":3861.5865677121,"171":3861.5120649628,"172":3861.8352774692,"173":3886.6138227867,"174":3882.3515370949,"175":3911.1675771676,"176":3913.7342750094,"177":3913.3418656536,"178":3922.9483620118,"179":3915.8871334133,"180":3914.6532410641,"181":3913.0622242549,"182":3913.534763944,"183":3913.8122478062,"184":3903.2417146172,"185":3903.7509450985,"186":3903.6130229859,"187":3903.6130229859,"188":3903.649177645,"189":3912.6638379112,"190":3910.8496029287,"191":3911.288685872,"192":3911.0468378574,"193":3911.2128609714,"194":3912.8404648319,"195":3913.3224173375,"196":3904.7147532633,"197":3904.1634634886,"198":3907.8722617981,"199":3906.2828706471,"200":3903.9030118149,"201":3905.3242981929,"202":3904.7974107902,"203":3903.5699626898,"204":3904.7694319346,"205":3910.8930373837,"206":3911.4476629107,"207":3911.42747673,"208":3912.286844006,"209":3912.3886369926,"210":3912.3420943513,"211":3913.0523389591,"212":3909.917938433,"213":3912.1447395762,"214":3910.9339614671,"215":3908.4309402705,"216":3908.4309402705,"217":3911.6453370209,"218":3911.9757363863,"219":3911.8231701897,"220":3924.3005838724,"221":3924.1597058313,"222":3918.3072522829,"223":3923.0025383978,"224":3922.648989012,"225":3876.1939152347,"226":3876.0255633,"227":3875.8271669081,"228":3875.2230341387,"229":3871.874721896,"230":3871.7848296923,"231":3862.8122323289,"232":3862.4880688772,"233":3870.2037044385,"234":3870.2037044385,"235":3855.1385513579,"236":3854.6861117949,"237":3855.0939644451,"238":3856.732266005,"239":3856.732266005,"240":3856.917529958,"241":3854.5651585737,"242":3856.9659431882,"243":3855.5956556052,"244":3854.248316446,"245":3876.6917868225,"246":3878.0538287595,"247":3878.0538287595,"248":3879.2261389343,"249":3877.1654175113,"250":3910.5580459332,"251":3918.7005996188,"252":3928.9646515886,"253":3928.9646515886,"254":3932.8705945412,"255":3913.0941334778,"256":3915.0539849534,"257":3917.9885124913,"258":3918.540611968,"259":3919.4566266617,"260":3920.7884518657,"261":3926.243660916,"262":3932.1042672717,"263":3945.6819784352,"264":3958.6205253452,"265":3955.63112804,"266":3956.422217191,"267":3951.24502232,"268":3948.9923000879,"269":3945.1307017013,"270":3940.4164457103,"271":3947.4083365549,"272":3950.4778707164,"273":3941.8867198363,"274":3944.9956969236,"275":3953.812213552,"276":3953.812213552,"277":3950.4539779509,"278":3943.1556330362,"279":3945.9193397056,"280":3934.9138318514,"281":3933.4643258158,"282":3933.4643258158,"283":3925.8382965154,"284":3933.7434425774,"285":3927.8201419014,"286":3938.1269461241,"287":3945.3653905429},"Close":{"0":3770.1906944402,"1":3769.8483295945,"2":3769.867140573,"3":3772.6717685996,"4":3776.4668124829,"5":3786.9402344311,"6":3799.7914382712,"7":3788.8328228523,"8":3771.6240759019,"9":3771.6615246171,"10":3772.3512758386,"11":3775.0813728046,"12":3771.3242780793,"13":3774.8282898239,"14":3771.0130442093,"15":3771.0130442093,"16":3773.9514721932,"17":3781.9230996675,"18":3787.0644746868,"19":3792.5813075788,"20":3793.4897125126,"21":3783.2387417512,"22":3783.2387417512,"23":3784.1610704482,"24":3787.4273230456,"25":3785.1497953997,"26":3780.8773260457,"27":3780.7974364833,"28":3779.1721854747,"29":3785.9197886135,"30":3787.0123587782,"31":3780.2333444785,"32":3782.2778421984,"33":3784.315032511,"34":3784.3832620036,"35":3785.9262430797,"36":3788.2320598506,"37":3786.5662173888,"38":3790.9862316209,"39":3788.7874049355,"40":3789.0238085397,"41":3793.1999180463,"42":3815.800161471,"43":3811.7616463359,"44":3808.8267471438,"45":3810.0618292369,"46":3796.1465000206,"47":3794.8316849747,"48":3799.6335622351,"49":3833.1342920881,"50":3817.0566333042,"51":3819.5763193748,"52":3823.7886162309,"53":3821.8956952819,"54":3822.4644232435,"55":3824.5805187074,"56":3825.3564808172,"57":3825.2002192883,"58":3824.6164913703,"59":3825.3232357202,"60":3824.8770454197,"61":3823.8954513506,"62":3824.2437917452,"63":3828.9638544406,"64":3822.5164124001,"65":3823.0388229082,"66":3822.7887303638,"67":3821.303510654,"68":3822.5856032616,"69":3822.1030535488,"70":3817.7834551938,"71":3817.3362645446,"72":3811.9320615685,"73":3817.702184965,"74":3817.6247403668,"75":3817.8712763696,"76":3817.6087327237,"77":3816.4620688419,"78":3817.1565827852,"79":3816.6602169842,"80":3816.1996749032,"81":3816.6515705732,"82":3816.406007046,"83":3816.3442445253,"84":3815.8260859651,"85":3816.847291646,"86":3816.3776055351,"87":3816.4556305309,"88":3817.7525596432,"89":3817.7636537081,"90":3818.8764613043,"91":3817.3653751593,"92":3817.9290763098,"93":3814.7422840426,"94":3817.832541133,"95":3813.8377976617,"96":3814.3527932988,"97":3814.2799916084,"98":3818.2732700501,"99":3814.0688792611,"100":3814.1555101343,"101":3814.5872951325,"102":3811.7284680451,"103":3813.4219294509,"104":3810.717617246,"105":3813.7341943528,"106":3815.0260961777,"107":3817.693976123,"108":3818.1323199797,"109":3818.4545637389,"110":3817.7259950528,"111":3818.2123968287,"112":3817.5090857173,"113":3818.2651422064,"114":3817.5385194413,"115":3814.3624427859,"116":3871.0100886869,"117":3856.1831838829,"118":3856.7392000211,"119":3892.2080958907,"120":3882.9925825804,"121":3878.9745445455,"122":3923.1045267681,"123":3911.8811828702,"124":3900.0366527431,"125":3900.7063731795,"126":3900.4699801422,"127":3896.9304053207,"128":3898.5454465514,"129":3898.5027092012,"130":3898.2245062292,"131":3897.6573309219,"132":3901.2469340733,"133":3899.5094893385,"134":3898.7778307428,"135":3901.2072078946,"136":3899.5398363774,"137":3897.943957195,"138":3897.943957195,"139":3897.8214418092,"140":3897.8214418092,"141":3897.3252693733,"142":3899.92548485,"143":3897.7760786952,"144":3890.7158529137,"145":3885.9365836417,"146":3887.3047826554,"147":3890.5314993053,"148":3875.418935081,"149":3849.0099459593,"150":3839.9425907106,"151":3838.0774450763,"152":3837.5817459317,"153":3835.7055833447,"154":3847.9894575663,"155":3840.2370819057,"156":3840.2370819057,"157":3840.2370819057,"158":3839.6455831804,"159":3840.2993000438,"160":3838.876463346,"161":3840.422611848,"162":3840.4051751439,"163":3840.4051751439,"164":3838.0762826072,"165":3839.8067458585,"166":3867.0197640658,"167":3859.1572742894,"168":3860.4510869931,"169":3860.4777118958,"170":3861.5865677121,"171":3861.5120649628,"172":3861.8352774692,"173":3886.6138227867,"174":3882.3515370949,"175":3911.1675771676,"176":3913.7342750094,"177":3913.3418656536,"178":3922.9483620118,"179":3915.8871334133,"180":3914.6532410641,"181":3913.0622242549,"182":3913.534763944,"183":3913.8122478062,"184":3903.2417146172,"185":3903.7509450985,"186":3903.6130229859,"187":3903.6130229859,"188":3903.649177645,"189":3912.6638379112,"190":3910.8496029287,"191":3911.288685872,"192":3911.0468378574,"193":3911.2128609714,"194":3912.8404648319,"195":3913.3224173375,"196":3904.7147532633,"197":3904.1634634886,"198":3907.8722617981,"199":3906.2828706471,"200":3903.9030118149,"201":3905.3242981929,"202":3904.7974107902,"203":3903.5699626898,"204":3904.7694319346,"205":3910.8930373837,"206":3911.4476629107,"207":3911.42747673,"208":3912.286844006,"209":3912.3886369926,"210":3912.3420943513,"211":3913.0523389591,"212":3909.917938433,"213":3912.1447395762,"214":3910.9339614671,"215":3908.4309402705,"216":3908.4309402705,"217":3911.6453370209,"218":3911.9757363863,"219":3911.8231701897,"220":3924.3005838724,"221":3924.1597058313,"222":3918.3072522829,"223":3923.0025383978,"224":3922.648989012,"225":3876.1939152347,"226":3876.0255633,"227":3875.8271669081,"228":3875.2230341387,"229":3871.874721896,"230":3871.9656184858,"231":3862.8122323289,"232":3862.4880688772,"233":3870.2037044385,"234":3870.2037044385,"235":3855.1385513579,"236":3854.6861117949,"237":3855.5660040051,"238":3856.732266005,"239":3856.732266005,"240":3856.917529958,"241":3854.5651585737,"242":3856.9659431882,"243":3855.5956556052,"244":3854.248316446,"245":3876.6917868225,"246":3878.0538287595,"247":3878.0538287595,"248":3879.2261389343,"249":3877.1654175113,"250":3910.5580459332,"251":3918.7005996188,"252":3928.9646515886,"253":3928.9646515886,"254":3932.8705945412,"255":3913.0941334778,"256":3915.0539849534,"257":3917.9885124913,"258":3918.540611968,"259":3919.4566266617,"260":3920.7884518657,"261":3926.243660916,"262":3932.1042672717,"263":3945.6819784352,"264":3958.6205253452,"265":3955.63112804,"266":3956.422217191,"267":3951.24502232,"268":3948.9923000879,"269":3945.1307017013,"270":3940.4164457103,"271":3947.4083365549,"272":3950.4778707164,"273":3941.8867198363,"274":3947.2299749811,"275":3953.812213552,"276":3953.812213552,"277":3950.4539779509,"278":3943.1556330362,"279":3945.9193397056,"280":3934.9138318514,"281":3933.4643258158,"282":3933.4643258158,"283":3925.8382965154,"284":3933.7434425774,"285":3927.8201419014,"286":3938.1269461241,"287":3945.3653905429},"Volume":{"0":3028191906.8121585846,"1":3036581627.820994854,"2":3019526239.845348835,"3":3028650598.2043933868,"4":3026765908.4060611725,"5":2998809971.0530819893,"6":3014413792.3835926056,"7":2998634521.4984436035,"8":2977987845.4814600945,"9":2972328833.1285691261,"10":2965930646.7233657837,"11":2964544740.4517807961,"12":2954401032.1571960449,"13":2956805493.8148255348,"14":2957566033.7675333023,"15":2957566033.7675333023,"16":2959474355.5535545349,"17":2958825459.9160971642,"18":2895831928.3396720886,"19":2924811491.0091714859,"20":2910214841.590303421,"21":2854754782.9908885956,"22":2854754782.9908885956,"23":2861044335.5762152672,"24":2781792131.1222624779,"25":2400727458.1147446632,"26":2442778699.005030632,"27":2173558431.4468932152,"28":2556194071.5157518387,"29":2220481322.4231700897,"30":2328326014.9440317154,"31":1658279889.1752960682,"32":874278602.3469963074,"33":777396849.5337916613,"34":1493028554.7518234253,"35":986281727.3372241259,"36":1904781672.4266648293,"37":1972085347.0169789791,"38":1308135756.5200030804,"39":860850770.7196336985,"40":857107029.1065366268,"41":1012132450.4270498753,"42":2642533862.4906845093,"43":2565285274.4132041931,"44":1874491261.3621888161,"45":1897869702.9604883194,"46":742386920.0158784389,"47":731484153.542023778,"48":776216917.0690478086,"49":1738371285.0660703182,"50":1147376242.005726099,"51":1617048081.1307241917,"52":1010855862.6626092196,"53":1023035517.6389180422,"54":1022368787.1911652088,"55":1023478284.3208384514,"56":1499711650.1419436932,"57":1003518389.1684250832,"58":1005306225.8213851452,"59":1049199865.8524087667,"60":1016431550.7855687141,"61":1056522406.8390337229,"62":1016211641.6221288443,"63":1446190251.2690262794,"64":1155434248.5354659557,"65":1037609165.5782401562,"66":1002237017.1329320669,"67":1026018074.2547069788,"68":1030274956.2299900055,"69":1014140237.9186145067,"70":1066093690.6726008654,"71":1032468123.3625720739,"72":1021413053.9573807716,"73":1188804278.5352499485,"74":1033759878.7432790995,"75":1036047966.8068580627,"76":1034355076.9589613676,"77":1055551791.4690133333,"78":1024929302.6931071281,"79":1040775177.0922342539,"80":1041252143.1774029732,"81":1041155192.8773491383,"82":1043767751.8000551462,"83":1044492694.7205181122,"84":1044058245.5071262121,"85":1042314611.9988542795,"86":1041814017.6247252226,"87":1041366074.3607412577,"88":1044262152.0722016096,"89":1046963422.3917602301,"90":1042962370.3670889139,"91":1041306599.7321481705,"92":1043028451.0760543346,"93":1081601304.742164135,"94":1079577195.3016912937,"95":1045201786.2652343512,"96":1038289180.0698910952,"97":1029709644.7035335302,"98":1028938169.3824334145,"99":1029119826.3000696898,"100":1019019532.5908236504,"101":1022052423.1219024658,"102":1032716712.8345887661,"103":1043992383.4321504831,"104":1033846375.3844271898,"105":1022304995.3183662891,"106":1045252745.9670299292,"107":1019625142.0430629253,"108":1019738584.1164594889,"109":1018128587.3023853302,"110":1017858488.8019779921,"111":1016638363.0914705992,"112":1016743457.4979989529,"113":1014446327.1625388861,"114":1036341453.5370616913,"115":1014630122.3600940704,"116":2424288237.9494915009,"117":1021623108.9620215893,"118":1022175997.1188751459,"119":1441496481.1173148155,"120":1042895743.0715928078,"121":1056632718.497091651,"122":1595989298.2441928387,"123":2611417225.4129767418,"124":1055789510.4736845493,"125":1058570480.4462810755,"126":1056361828.6204463243,"127":1052975734.2682142258,"128":1714542208.9194145203,"129":1124107513.1028239727,"130":1126787460.9253475666,"131":1593219546.8654716015,"132":1293255416.8429608345,"133":1048142052.6197501421,"134":1047197374.2864105701,"135":1092786371.3941380978,"136":1388762159.4023318291,"137":1060506318.083006978,"138":1060506318.083006978,"139":1018859127.4007848501,"140":1018859127.4007848501,"141":1022113208.1108646393,"142":1049668392.9206265211,"143":1050500643.8479331732,"144":1897651606.4495084286,"145":1837328363.9984736443,"146":1833136985.1607811451,"147":1771254157.7711322308,"148":2607147603.9186067581,"149":2381189419.0521597862,"150":1389172538.2265334129,"151":1121444546.6911745071,"152":1004763867.6411076784,"153":1031665045.7726545334,"154":1669888138.081022501,"155":1030524854.3682162762,"156":1030524854.3682162762,"157":1030524854.3682162762,"158":1032495769.746956706,"159":1031533426.2868338823,"160":1033398247.9660857916,"161":1034534583.1007448435,"162":1023616968.4660873413,"163":1023616968.4660873413,"164":1005699935.9494193792,"165":1015340403.5026965141,"166":1816480871.2073807716,"167":1114264773.2321643829,"168":1092096395.4899573326,"169":1020958206.3531507254,"170":1024972596.2797628641,"171":1045479623.0422030687,"172":1045869728.3586186171,"173":1070392273.9937735796,"174":1662616537.6084470749,"175":1138008794.275783062,"176":1028102699.8030295372,"177":1054695928.0127109289,"178":1726866410.3407735825,"179":1013999777.2350749969,"180":1058799104.4235351086,"181":2590569746.7607855797,"182":1398844610.6219806671,"183":2585957508.613049984,"184":1022373481.1213930845,"185":1058142748.4361686707,"186":1040145426.4384117126,"187":1040145426.4384117126,"188":1039325943.0420860052,"189":1336086089.5894806385,"190":1028162374.8649476767,"191":1050307445.808193922,"192":1050384028.8477727175,"193":1051613237.1767101288,"194":1024350482.983963728,"195":1325988542.1700422764,"196":1073295743.9734266996,"197":1008960063.1407067776,"198":1049018784.7088267803,"199":2435584407.7840600014,"200":1014657588.5562338829,"201":1015848456.2380378246,"202":1114254955.7640652657,"203":1017592873.1375524998,"204":1240652990.8087384701,"205":1919615514.0472009182,"206":1767574640.7152321339,"207":976517318.6854605675,"208":999915585.0961751938,"209":1025423023.516384244,"210":1022029672.1091265678,"211":944320298.6192345619,"212":968408144.8243652582,"213":944799677.8957434893,"214":981709332.301969409,"215":979366884.8570404053,"216":979366884.8570404053,"217":996876384.8858109713,"218":997165635.5976862907,"219":995273692.0124306679,"220":934447664.4251910448,"221":970450407.7358999252,"222":1005674270.1242593527,"223":942000347.616713047,"224":983237896.6378173828,"225":926041665.9951680899,"226":950982518.6857594252,"227":947386715.3827769756,"228":973152267.9261510372,"229":912617757.7717981339,"230":924938774.8799829483,"231":905999291.2518442869,"232":951861387.3783043623,"233":1743449733.699877739,"234":1743449733.699877739,"235":940094427.4594180584,"236":969840115.5363469124,"237":933174910.2995772362,"238":926552115.5352293253,"239":926552115.5352293253,"240":963411207.0363762379,"241":914720407.1790952682,"242":952857134.2256833315,"243":944067484.6911463737,"244":944934132.8203456402,"245":917055737.0782272816,"246":946624969.125397563,"247":946624969.125397563,"248":960002167.3974206448,"249":959052153.8582617044,"250":2416020135.0959191322,"251":1884638573.2666387558,"252":1977694899.6381063461,"253":1977694899.6381063461,"254":1510832028.9405531883,"255":2279907958.8116588593,"256":861637208.5310801268,"257":938006243.2889164686,"258":817444822.1284601688,"259":1353954865.7305111885,"260":1197104858.6319169998,"261":503014033.1952778697,"262":906123248.6516269445,"263":1267395028.6221985817,"264":850356142.896089673,"265":817922127.2191313505,"266":1013941085.776231885,"267":942803847.2189317942,"268":905563418.2512568235,"269":1386060673.2986223698,"270":1560471855.8170421124,"271":1432494947.1700370312,"272":517790132.5331386924,"273":1244644188.4691390991,"274":859534356.0515899658,"275":554183181.024189949,"276":554183181.024189949,"277":1120463716.6618995667,"278":1739312900.5475099087,"279":766509406.9284172058,"280":1722479199.3000750542,"281":1543716661.4581592083,"282":1543716661.4581592083,"283":1850558165.9246468544,"284":925013752.7955344915,"285":1551425471.2333605289,"286":1303262068.5436990261,"287":1409154537.3924152851}}',
    "portfolio_data": {
        "So11111111111111111111111111111111111111112": 10,
        "7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs": 0,
    },
    "token_id": "7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs",
}


def read_ohlcv(file_path: str) -> tuple:
    """Helper function to read ohlcv data."""
    df = pd.read_csv(file_path)
    timestamps = pd.to_datetime(df["Date Time"]).tolist()
    prices = df["Close"].tolist()
    volumes = df["Volume"].tolist()
    return timestamps, prices, volumes


@pytest.fixture
def raw_data():
    """Generate raw data for testing."""
    timestamps, prices, volumes = read_ohlcv(OHLCV_DATA)
    TEST_RAW_DATA = {
        "volumes": [(ts, val) for ts, val in zip(timestamps, volumes)],
        "prices": [(ts, val) for ts, val in zip(timestamps, prices)],
    }
    return TEST_RAW_DATA


@pytest.mark.parametrize("func,path", [(read_ohlcv, OHLCV_DATA)])
def test_generate_data(func, path):
    """Test the data generation function."""
    timestamps, prices, volumes = func(path)
    assert len(timestamps) == len(prices) == len(volumes)


@pytest.mark.parametrize("strategy", strategies)
def test_evaluate(strategy, raw_data):
    """Test the evaluate function."""
    data = strategy.transform(**raw_data)
    results = strategy.evaluate(**data, plot=False, asset="olas")
    assert "sharpe_ratio" in results


@pytest.mark.parametrize("strategy", strategies)
def test_transform(strategy, raw_data):
    """Test the transform function."""
    strategy.transform(**raw_data)


@pytest.mark.parametrize("strategy", strategies)
def test_run(strategy, raw_data):
    """Test the complete strategy."""
    kwargs = strategy.transform(**raw_data)
    result = strategy.run(**kwargs, portfolio_data={"token_a": 1000, "USDT": 1000})
    assert (
        "error" not in result
    ), f"Error in {strategy.__name__} strategy: {result['error']}"


@pytest.mark.parametrize("strategy", strategies)
def test_optimise(strategy, raw_data):
    """Test the optimise function."""
    kwargs = strategy.transform(**raw_data)
    result = strategy.optimise(**kwargs, portfolio_data={"token_a": 1000, "USDT": 1000})
    assert (
        "error" not in result
    ), f"Error in {strategy.__name__} strategy: {result['error']}"


@pytest.mark.parametrize("strategy", strategies)
def test_run_sample(strategy, raw_data):
    """Test the run_sample function."""
    result = strategy.run(**SAMPLE_RUN_DATA)
    assert (
        "error" not in result
    ), f"Error in {strategy.__name__} strategy: {result['error']}"
